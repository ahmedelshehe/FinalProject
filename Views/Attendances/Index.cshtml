@model X.PagedList.StaticPagedList<Attendance>
@using FinalProject.Utilities;
@using X.PagedList;
@using X.PagedList.Mvc.Core;
@using X.PagedList.Mvc.Core.Fluent
@using X.PagedList.Web.Common;
﻿@{
    var pagedList = (IPagedList)Model;
}
<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />

@{
    ViewData["Title"] = "Attendance Dashboard";
    var permissions = Context.Items["Permissions"] as List<Permission>;


    var canShowAttendance = permissions.HasPermission("Attendance",Operation.Show);
    var canAddAttendance = permissions.HasPermission("Attendance", Operation.Add);
    var canUpdateAttendance = permissions.HasPermission("Attendance", Operation.Update);
    var canDeleteAttendance = permissions.HasPermission("Attendance", Operation.Delete);
}

<div class="row m-5 align-content-between align-items-center welcome-box">
    <div class="col ">
        <div>
            <div class="welcome-det">
                <h3>Attendance Dashboard</h3>
            </div>
        </div>
    </div>
    <div class="col-3 container shadow row align-items-center py-3 mr-3">
        <div >
            <form asp-action="Search" class="form-inline">
                <div class="form-group">
                    <input type="date" name="Date" class="form-control mr-2" />
                    <button type="submit" class="btn btn-outline-info  mr-2">Search</button>
                    <a asp-action="Index"><i class="fa-solid fa-arrows-rotate fa-l" style="color: #000000;"></i></a>
                </div>
            </form>
        </div>
    </div>
    <div class="col-2 " @(canAddAttendance)>
        <div class="container shadow row align-items-center py-3">
            <div class="col">
                <a asp-action="Create"><i class="fa-sharp fa-solid fa-plus fa-2xl"></i></a>
            </div>
            
            <div class="col">
                <a asp-action="UploadFile">
                    <i class="fa-regular fa-file-excel fa-2xl" style="color: #135007;"></i>
                </a>
            </div>
            <div class="col">
                <a asp-action="SearchIndex"><i class="fa-brands fa-searchengin fa-2xl" style="color: #665ecf;"></i></a>
            </div>
        </div> 
    </div>
</div>

<div class="row align-items-start align-content-between">
    <div class="card p-3 shadow col-10 ml-5" id="attendance-index-print">
        <div class="welcome-det print-on">
            <h3>Attendance Report</h3>
        </div>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>
                        Employee
                    </th>
                    <th>
                        Arrival Time
                    </th>
                    <th>
                        Departure Time
                    </th>
                    <th>
                        Date
                    </th>

                    <th colspan="3" class="print-off">
                        Actions
                    </th>

                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Employee.FirstName  ) @Html.DisplayFor(modelItem => item.Employee.LastName  )
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.ArrivalTime)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.DepartureTime)
                        </td>
                        <td>
                            @item.Date.ToString("dd MMM yyy")
                        </td>

                        <td class ="print-off" @(canUpdateAttendance)>
                            <a asp-action="Edit" asp-route-id="@item.EmployeeId" asp-route-date="@item.Date">
                                <i class="fa-solid fa-pen-to-square fa-lg" style="color: #000000;"></i>
                            </a>
                        </td>
                        <td class="print-off" @(canShowAttendance)>
                            <a asp-action="Details" asp-route-id="@item.EmployeeId" asp-route-date="@item.Date"><i class="fa-solid fa-circle-info fa-l" style="color: #000000;"></i></a>
                        </td>
                        <td class ="print-off" @(canDeleteAttendance)>
                            <a asp-action="Delete" asp-route-id="@item.EmployeeId" asp-route-date="@item.Date"><i class="fa-solid fa-trash fa-l" style="color: #000000;"></i></a>
                        </td>

                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="col">
        <a  onclick="printContent('attendance-index-print')" style="cursor:pointer;"><i class="fa-solid fa-print fa-2xl" style="color: #00276b;"></i></a>
    </div>
</div>


<div id="container" style="margin-left: 20px">
    <div class="pagination" style="margin-left: 400px">
        @Html.PagedListPager(pagedList, page => Url.Action("Index", new { page }), new PagedListRenderOptions
               {                       
                        DisplayLinkToIndividualPages = true,
                        DisplayPageCountAndCurrentLocation = false,
                        MaximumPageNumbersToDisplay = 10,
                        UlElementClasses =new string[] {"pagination justify-content-end"},
                        LiElementClasses = new string[] { "page-item" },
                        PageClasses = new string[] { "page-link" },
                   
                    })
    </div>
</div>